<!--求职者个人简历页-->
<!-- 加载过滤器 -->
<wxs src="../../../../utils/filters.wxs" module="filters" />
<navbar title="简历详情" background="#FFFFFF" color="#22292C" showHome="{{true}}"></navbar>
<view hidden="{{!hasReFresh}}">
  <refreshStatus></refreshStatus>
</view>

<view class="resumeDetail {{isOwner? '' : 'addpadding'}}" wx:if="{{info}}">
  <shareBtn wx:if="{{!isOwner}}"></shareBtn>
  <view class="previewFile" wx:if="{{info.resumeAttach && !isOwner}}" bindtap="previewFile" data-file="{{info.resumeAttach.url}}">
    <view class="fileName"><image class="fileIcon" src="{{cdnImagePath}}jianliIcon.png"></image><text>该候选人已上传附件简历</text></view>
    <view class="previewBtn"><text>在线查看</text><i class="btnIcon iconfont icon-disejiantou-you"></i></view>
  </view>
<!-- 基本信息 -->
  <view class="personalInfo commentBox">
    <view class="top">
      <view class="avatarBox" bindtap="readAvatar">
        <image src="{{info.avatar.smallUrl}}" class="avatar"></image>
        <view class="gender">
          <image class="sexIcon" src="{{cdnImagePath}}nan.png" wx:if="{{info.gender === 1}}"></image>
          <image class="sexIcon" src="{{cdnImagePath}}nv.png" wx:else></image>
        </view>
      </view>
      <view class="info">
        <view class="name"><text>{{info.name}}</text><i class="icon iconfont icon-bianji1 edit" data-editName="info" data-id="{{item.id}}" bindtap="edit" wx:if="{{isOwner}}"></i></view>
        <view wx:if="{{info.lastCompanyName}}">
          <text>{{info.lastCompanyName}}</text> | <text>{{info.lastPosition}}</text>
        </view>
      </view>
    </view>
    <view class="experience">
      <view class="time"><i class="icon iconfont icon-zhiwei"></i>{{info.workAgeDesc}}</view>
      <view class="age" wx:if="{{info.age}}"><i class="icon iconfont icon-nianling"></i>{{info.age}}岁</view>
      <view class="education"> <i class="icon iconfont icon-xueli"></i>{{info.degreeDesc}}</view>
      <view class="status" wx:if="{{info.jobStatusDesc}}">{{info.jobStatusDesc}}</view>
    </view>
    <block wx:if="{{info.signature}}">
      <image class="line" src="{{cdnImagePath}}line.png"></image>
      <view class="personalTip">
        <view class="text">{{info.signature || '你还未填写个性签名，说说你的想法吧~'}}</view>
        <view class="tipBox">
          <text class="tip" wx:for="{{info.personalizedLabels}}" wx:key="{{index}}">{{item.labelName || item.name}}</text>
        </view>
      </view>
    </block>
  </view>
  <!-- 意向 -->
  <view class="intent commentBox" wx:if="{{(!isOwner && info.expects.length > 0) || isOwner}}">
    <view class="intentTitle"><view class="commontIcon"><view class="box"></view></view> 求职意向</view>
    <!-- 意向列表 -->
    <view class="officeTab" wx:for="{{info.expects}}" wx:if="{{index < 3}}" wx:key="{{index}}">
      <view>
        <view class="officeDetail">
          <text class="name">{{item.position}} | {{item.city}}</text>
          <text class="salary">{{item.salaryFloor}}~{{item.salaryCeil}}K</text>
          <i class="icon iconfont icon-bianji1 edit" data-editName="intent" data-id="{{item.id}}" bindtap="edit" wx:if="{{isOwner}}"></i></view>
      </view>
      <view class="officeInfo">
        <block wx:for="{{item.fields}}" wx:for-item="officeInfo" wx:for-number="{{item.fields.length}}" wx:key="{{index}}">
          <text>{{officeInfo.field || officeInfo.name}} <block wx:if="{{item.fields.length - 1 !== index}}" > · </block></text>
        </block>
      </view>
    </view>
    <text class="add" data-editName="intent" bindtap="edit" wx:if="{{isOwner && info.expects.length < 3}}" data-id="">添加求职意向</text>
  </view>
  <!-- 工作经历 -->
  <view class="workExp commentBox" wx:if="{{(!isOwner && info.careers.length > 0) || isOwner}}">
    <view class="intentTitle"><view class="commontIcon"><view class="box"></view></view> 工作经历</view>
    <view class="listCareers">
      <view class="expTab" wx:for="{{info.careers}}" wx:key="{{index}}" wx:if="{{isOwner || (!isOwner && index < showLimit)}}">
        <view class="expTitle">
          <text class="expName {{isOwner ? 'ellipsis':''}}">{{item.company}}</text>
          <text class="expTime" wx:if="{{item.endTime}}">{{filters.dateFormat(item.startTime, 'YYYY.MM')}}-{{filters.dateFormat(item.endTime, 'YYYY.MM')}}</text>
          <text class="expTime" wx:else>{{filters.dateFormat(item.startTime, 'YYYY.MM')}}-至今</text>
          <i class="icon iconfont icon-bianji1 edit" data-editName="work" data-id="{{item.id}}" bindtap="edit" wx:if="{{isOwner}}"></i>
        </view>
        <view class="expInfo">{{item.position}}</view>
        <!-- 工作内容 -->
        <shrinkText class="expContent" wx:if="{{item.duty}}" textData="{{item.duty}}" line="{{isOwner ? 1 : 0}}"></shrinkText>
        <!-- 工作标签 -->
        <view class='expTip' wx:if="{{item.technicalLabels.length > 0}}">
          <text wx:for="{{item.technicalLabels}}" wx:key="{{index}}"># {{item.labelName}}</text>
        </view>
      </view>
    </view>
    <view class="openbtn" bindtap="openMoreCareer" wx:if="{{!isOwner && info.careers.length > 3 && showLimit === 3}}">展开全部{{info.careers.length}}个工作经历<i class="icon iconfont icon-zhishibiao {{showLimit === 100 ? 'shrink':''}}"></i></view>
    <view class="openbtn" bindtap="openMoreCareer" wx:if="{{!isOwner && info.careers.length > 3 && showLimit === 100}}">折叠收起<i class="icon iconfont icon-zhishibiao {{showLimit === 100 ? 'shrink':''}}"></i></view>
    <text class="add" data-editName="work" bindtap="edit" wx:if="{{isOwner && info.careers.length < 10}}" data-id="">添加工作经历</text>
  </view>
  <!-- 项目经历 -->
  <view class="projectExp commentBox" wx:if="{{(!isOwner && info.projects.length > 0) || isOwner}}">
    <view class="intentTitle"><view class="commontIcon"><view class="box"></view></view> 项目经历</view>
    <view class="expTab" wx:for="{{info.projects}}" wx:key="{{index}}">
      <view class="expTitle">
        <text class="expName {{isOwner ? 'ellipsis':''}}">{{item.name}}</text>
        <text class="expTime" wx:if="{{item.endTime}}">{{filters.dateFormat(item.startTime, 'YYYY.MM')}}-{{filters.dateFormat(item.endTime, 'YYYY.MM')}}</text>
        <text class="expTime" wx:else>{{filters.dateFormat(item.startTime, 'YYYY.MM')}}-至今</text>
        <i class="icon iconfont icon-bianji1 edit" data-editName="project" data-id="{{item.id}}" bindtap="edit" wx:if="{{isOwner}}"></i>
      </view>
      <view class="expInfo">{{item.role}}</view>
      <!-- 工作内容 -->
      <shrinkText class="expContent" wx:if="{{item.description}}" textData="内容：{{item.description}}" line="{{isOwner ? 1 : 0}}"></shrinkText>
      <!-- 相关链接 -->
      <view class="link" wx:if="{{item.link}}">链接：<text bindtap="copy" data-copyData="{{item.link}}">{{item.link}}</text>
      </view>
    </view>
    <text class="add" data-editName="project" bindtap="edit" wx:if="{{isOwner && info.projects.length < 11}}" data-id="">添加项目经历</text>
  </view>
  <!-- 教育经历 -->
  <view class="projectExp commentBox" wx:if="{{(!isOwner && info.educations.length > 0) || isOwner}}">
    <view class="intentTitle"><view class="commontIcon"><view class="box"></view></view> 教育经历</view>
    <view class="expTab" wx:if="{{info.educations.length < 11}}" wx:for="{{info.educations}}" wx:key="{{index}}">
      <view class="expTitle">
        <text class="expName {{isOwner ? 'ellipsis':''}}">{{item.school}}</text>
        <text class="expTime" wx:if="{{item.endTime}}">{{filters.dateFormat(item.startTime, 'YYYY.MM')}}-{{filters.dateFormat(item.endTime, 'YYYY.MM')}}</text>
        <text class="expTime" wx:else>{{filters.dateFormat(item.startTime, 'YYYY.MM')}}-至今</text>
        <i class="icon iconfont icon-bianji1 edit" data-editName="education" data-id="{{item.id}}" bindtap="edit" wx:if="{{isOwner}}"></i>
      </view>
      <view class="expInfo">{{item.degreeDesc}}·{{item.major}}</view>
      <!-- 教育经历 -->
      <shrinkText class="expContent" wx:if="{{item.experience}}" textData="{{item.experience}}" line="{{isOwner ? 1 : 0}}"></shrinkText>
    </view>
    <text class="add" data-editName="education" bindtap="edit" wx:if="{{isOwner && info.educations.length < 11}}" data-id="">添加教育经历</text>
  </view>
  <!-- 更多 -->
  <view class="more commentBox" wx:if="{{(!isOwner && info.moreIntroduce.introduce || info.moreIntroduce.imgs.length > 0) || isOwner}}">
    <view class="intentTitle moreTitle">
      <view><view class="commontIcon"><view class="box"></view></view> 更多介绍 </view>
      <i class="icon iconfont icon-bianji1 edit" data-editName="more" data-id="{{item.id}}" bindtap="edit" wx:if="{{(info.moreIntroduce.introduce || info.moreIntroduce.imgs.length > 0) && isOwner}}"></i>
    </view>
    <view class="expTab" hidden="{{!info.moreIntroduce.introduce && info.moreIntroduce.imgs.length === 0}}">
      <!-- 工作内容 -->
      <shrinkText textData="{{info.moreIntroduce.introduce}}" wx:if="{{info.moreIntroduce.introduce}}" line="{{isOwner ? 1 : 0}}"></shrinkText>
      <view class="imgBox" wx:if="{{info.moreIntroduce.imgs.length > 0}}">
        <image wx:for="{{info.moreIntroduce.imgs}}" wx:key="{{index}}" mode="aspectFill" src="{{item.smallUrl}}" bindtap="preview" data-current="{{item.url}}"></image>
      </view>
    </view>
    <text class="add" data-editName="more" bindtap="edit" wx:if="{{!info.moreIntroduce.introduce && info.moreIntroduce.imgs.length === 0 && isOwner}}" data-id="0">完善更多介绍</text>
  </view>
</view>
<view wx:if="{{!realIsOwner}}" class="collect" bindtap="collect">
  <i class="icon iconfont icon-ganxingqu" wx:if="{{!info.interested}}"></i>
  <i class="icon iconfont icon-biaojiweiganxingqu" wx:else></i>
</view>
<!-- 底部开撩 -->
<view class="bottomBox">
  <view>
    <interviewBar
      id="interviewBar"
      infos="{{info}}"
      type="resume"
      bindresultevent="init"
      wx:if="{{info.vkey && !isOwner}}"></interviewBar>
  </view>
</view>
